/*
 * jQuery RippleCSS plugin 0.1
 * 
 * A webkit experiment for creating water ripples using
 * jQuery and CSS3 animations.
 * 
 * Copyright 2013 Andreas Larsson <andreas@chromawoods.com> - http://chromawoods.com/
 * Released under the WTFPL license: http://www.wtfpl.net/
 */
(function(a){a.fn.ripple=function(e){var d,c,h,b=a(this),g={ripplesPerSecond:2,ripplesPerCluster:2,animationDuration:1000,rippleInterval:200,opacity:".4",clusterClass:"cluster",rippleClass:"ripple",expandClass:"expand",doneClass:"done"},f=a.extend({},g);a.extend(f,e);f.spawnInterval=parseInt(1000/f.ripplesPerSecond);h=a("<div/>",{"class":f.clusterClass,html:(function(j){var l="";for(var k=0;k<j;k++){l+='<div class="'+f.rippleClass+'"></div>';}return l;})(f.ripplesPerCluster)});d=function(j){var k=[],o=0,l,n,i=j.children(),m={top:Math.floor(Math.random()*99)+"%",left:Math.floor(Math.random()*99)+"%",opacity:f.opacity,"-webkit-animation-duration":f.animationDuration+"ms"};i.each(function(){k.push(a(this));});j.removeClass(f.doneClass);l=(function l(){var p=true;if(o<k.length){k[o].css(m).addClass(f.expandClass);if(k[o].is(":last-child")){p=false;n=k[o];n.on("webkitAnimationEnd",function(){j.addClass(f.doneClass);i.removeClass(f.expandClass);});}}if(p){setTimeout(function(){o++;l();},f.rippleInterval);}})();};c=(function c(){setTimeout(function(){webkitRequestAnimationFrame(c);(function(i){i=i.length?i:h.clone().appendTo(b);d(i);})(b.children("."+f.clusterClass+"."+f.doneClass));},f.spawnInterval);})();};}(jQuery));